(window["webpackJsonpmbase2modules"] = window["webpackJsonpmbase2modules"] || []).push([[38,46],{

/***/ 18:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _libs_exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(7);
/* harmony import */ var _app_globals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(0);
/**
 * handles excel file upload
 */




/* harmony default export */ __webpack_exports__["default"] = (async (op = {}) => {
const [
    ComponentManager,
    utils,
    mutils
] = await Promise.all([
    _libs_exports__WEBPACK_IMPORTED_MODULE_0__["ComponentManager"](),
    _libs_exports__WEBPACK_IMPORTED_MODULE_0__["utils"](),
    _libs_exports__WEBPACK_IMPORTED_MODULE_0__["mutils"]()
]);

const components = {};
components.select = _libs_exports__WEBPACK_IMPORTED_MODULE_0__["select"]({
    label: `Data source file`, 
    onSelect: op.onSelect, 
    url: _app_globals__WEBPACK_IMPORTED_MODULE_1__[/* default */ "a"].apiRoot + '/uploaded-files/private' + (op.subfolder !== undefined ? '/' + op.subfolder : ''),
    process: d => [d.id, d.file_name + (d.file_number === 0 ? '' : ` (${d.file_number})` )]
}, true, _libs_exports__WEBPACK_IMPORTED_MODULE_0__["TTomSelect"]);

components.button = {
    module: _libs_exports__WEBPACK_IMPORTED_MODULE_0__["FileUploadButton"],
    options: {
        onChange: onFileSelected
    }
}

await utils.loadComponents(components);

const cm = new ComponentManager.default();
await cm.add(components.select, false, op.$parent);
await cm.add(components.button, false, op.$parent);

async function onFileSelected(file) {
    const res = await utils.request(_app_globals__WEBPACK_IMPORTED_MODULE_1__[/* default */ "a"].apiRoot + '/file-upload/private' + (op.subfolder !== undefined ? '/' + op.subfolder : ''), 'POST', file, mutils.requestCallbacksHelper());
    if (res === false) return;
    
    const data = cm.getData('select');
    data.push(res);
    const select = cm.refresh('select');
    select.val(res.id);
}
    return cm;
});

/***/ }),

/***/ 90:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _libs_exports__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(7);
/* harmony import */ var _app_globals__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(0);
/* harmony import */ var _helpers_fileUpload__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(18);
/* harmony import */ var _libs_mbase2_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(12);







/* harmony default export */ __webpack_exports__["default"] = (async op => {
    const {$parent} = op;

    let fileUploadCm = null;

    fileUploadCm = await _helpers_fileUpload__WEBPACK_IMPORTED_MODULE_2__["default"]({onSelect: onDataFileSelect, $parent: $parent, subfolder: 'dmg'});

    async function onDataFileSelect(e) {

        if (!fileUploadCm) return;

        const pages = await _libs_mbase2_utils__WEBPACK_IMPORTED_MODULE_3__["requestHelper"](_app_globals__WEBPACK_IMPORTED_MODULE_1__[/* default */ "a"].apiRoot + `/dmg-parse-price-list/${fileUploadCm.get('select').val()}`, 'POST'); 

        const Button =  await _libs_exports__WEBPACK_IMPORTED_MODULE_0__["Button"]();

        const uploadBtn = new Button.default({
            label:`Apply`,
            type: 'btn-primary',
            classes: 'btn-lg',
            onClick: () => {
            },
            $parent: $parent
        });

    }
});


/***/ })

}]);